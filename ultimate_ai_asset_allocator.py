<-- Full code as written above -->